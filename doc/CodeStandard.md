# 代码规范

## 缩进

统一使用2个空格作为一个缩进单位

## 行宽

每行代码尽量不超过40个字符，特殊情况下可以超过。

* 方便半屏查看代码
* 增强可读性

## 字符串

* 自然语言使用双引号，其他情况一般使用单引号
* 正则表达式使用双引号
* `doc-strings`使用三个双引号
* 格式化字符串统一使用f-string

## 空格

* 在二元运算符两边各空一格
* 参数列表的`,`后留一个空格
* 函数的参数列表中，默认值的等号两边不留空格
* 左括号之后，右括号之前不留空格
* 字典的key的左括号前不留空格，即`dict['key'] = value`
* 不要为对齐赋值语句而使用额外空格

## 换行

* 换行后，缩进两个缩进单位
* 可以使用反斜杠`\`换行，
  * 使用时，`运算符`和`.`、`%`等符合应出现在行末
  * 长字符串也可以用反斜杠换行
* 禁止使用复合语句，即一行中包含多个语句
* `if/for/while/try`一定要换行
* 极不推荐使用`;`

## 空行

* 模块级函数和类定义之间空两行
* 类成员函数之间空一行
* 可以使用空行分隔多组相关的函数
* 函数中可以使用空行分隔出逻辑相关的代码
* 文档后面最多留两个空行

## Import

* 分开导入，避免使用逗号
* 一般使用`absolute import`
* 一般应该位于文件头部，置于模块说明以及`doc-string`之后，在全局变量之前
* 应该按照顺序排列，按照Python自带模块、第三方模块、项目内模块分为三组，每组之间用一个空行分隔
* 如果发生命名冲突，可以使用命名空间
* 使用项目内其他模块，一律使用from形式

## 注释

* 尽可能避免添加无效注释
* 如无特殊情况，文件一律使用`UTF-8`编码，在文件头部加入标识。`# -*-coding:utf-8-*-`
* `#`后空一格
* 块注释中，段落之间用空行分开（空行同样需要`#`）
* 行注释中，至少使用两个空格和语句分开
* 在代码的关键部分，或者比较复杂的地方，能写注释尽量要写注释
* 标注part，或者非常重要的注释，使用等号单独隔开，使其突出
* 可以使用`Codetags`，推荐使用`TODO`、`FIXME`

## Doc-String

* 写在模块、类、函数的头部，在python可以通过对象的`__doc__`对象获取文档，编辑器和IDE也可以根据Docstring给出自动提示
* 以`"""`开头和结尾，首行不换行。除非只有一行否则末行单独一行
* 不要在文档注释复制函数定义原型, 而是具体描述其具体内容, 解释具体参数和返回值等
* 文档注释不限于中英文, 但尽量不要中英文混用，即要么纯中文，要么纯英文(部分名词除外)
* 文档注释不是越长越好, 通常一两句话能把情况说清楚即可
* 模块文档：采用自定义Google风格。至少包含文件位置和描述。
* 类文档：首行一句话定义该类，然后是描述。
  * 文档中可以有一个属性（Attributes）段，格式与函数参数相同。也可以说明使用方法（Usage），或者包含的公有方法（Methods）等，这些非必须。采用自定义Google风格。
* 函数文档：首行一句话说明功能，然后是描述。
  * 后续是标准的参数（Args）、返回值/生成器返回值（Returns/Yields）、异常（Raises），这些部分的内容都需要缩进。
  * 参数中列出每个参数的名字，并在名字后面使用一个冒号和一个空格，然后是描述（包括所需的类型和含义）。
  * 返回值如果为`None`，可以忽略，否则需要描述返回值的类型和含义。
  * 异常要列出与接口有关的所有异常。自定义风格。
* 不添加文档的条件：
  * 是函数
  * 外部不可见
  * 非常短小
  * 简单明了

## 许可

* 许可文件为项目根目录的`LICENSE`

## 包命名

* 使用纯小写命名
* 只使用一个单词
* 使用单数形式
* 尽量避免与Python包以及第三方包重名

## 模块命名

* 使用纯小写命名
* 尽量只使用一个单词，多个单词之间使用下划线分隔
* 私有模块前加下划线
* 尽量避免与Python包以及第三方包重名

## 类命名

* 使用驼峰命名风格，例：`SampleClass`
* 首字母大写
* 私有类前加下划线

## 函数/方法命名

* 使用Snack-Like命名风格，例：`sample_function`
* 一律小写
* 私有函数前加下划线

## 变量/属性命名

* 变量名一律小写
* 单词之间使用下划线
* 私有变量前加下划线
* 不使用的变量使用`_`来接收，比如`for _ in range(5)`

## 常量命名

* 常量名一律纯大写
* 单词之间使用下划线

## 文件

* 每个包里面最好都有一个`__init__.py`文件，尽管在python3之后并非必须

## 其他规范

* 只允许使用简单的列表/字典推导式，保证代码可读性和可维护性
* 尽量少使用奇怪的魔法方法，如果使用，必须写好注释和`doc-string`
* `if...else...`不超过三层
* 定义对象、变量、try等操作尽量在循环体外，特殊情况除外
* 避免出现重复的代码，即DRY原则（Don’t Repeat Yourself）
